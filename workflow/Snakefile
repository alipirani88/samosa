configfile: "config/config.yaml"


import pandas as pd

samples_df = pd.read_table(config["samples"]).set_index("sample", drop=False)
SAMPLES = list(samples_df['sample'])


rule all:
    input:
        bamdedupindex=expand("DedupReads/{sample}_aln_marked.bam.bai", sample=SAMPLES),
        samtoolsreferenceindex = config["reference_path"] + ".fai",
        rawvcf=expand("freebayes/{sample}_raw.vcf", sample=SAMPLES),

# delete everything so we can re-run things
rule clean:
    shell: 'rm -r trimmed/* freebayes/* mapped/* DedupReads/*'


# Add Modular rules
include: "rules/trim.smk"
include: "rules/bowtie.smk"
include: "rules/gatk.smk"
include: "rules/samtools.smk"
include: "rules/freebayes.smk"